const float noise_matrix[] = {
0.0902, 0.5253, 0.2544, 0.3770, 0.1745, 0.8618, 0.4524, 0.8733, 0.9807, 0.2644, 0.8060, 0.3686,
0.0672, 0.9201, 0.0770, 0.7183, 0.6692, 0.8894, 0.5655, 0.6686, 0.2979, 0.3051, 0.3822, 0.9344,
0.3148, 0.3248, 0.0872, 0.6348, 0.3224, 0.4449, 0.0837, 0.6950, 0.9218, 0.8830, 0.4704, 0.9596,
0.4132, 0.4494, 0.9667, 0.6843, 0.7118, 0.0361, 0.7094, 0.5285, 0.2440, 0.4806, 0.7709, 0.0939,
0.2972, 0.7955, 0.5487, 0.4476, 0.1652, 0.0297, 0.0136, 0.6927, 0.0863, 0.2484, 0.9325, 0.0581,
0.6301, 0.3063, 0.7744, 0.4389, 0.2809, 0.8464, 0.0257, 0.7527, 0.8578, 0.1306, 0.7507, 0.0628,
0.2404, 0.1328, 0.8225, 0.1550, 0.2779, 0.3710, 0.9801, 0.5946, 0.8687, 0.1095, 0.7630, 0.4243,
0.9531, 0.1834, 0.8483, 0.3572, 0.6179, 0.5665, 0.3229, 0.3274, 0.6268, 0.8001, 0.8902, 0.8126,
0.5846, 0.3099, 0.8762, 0.0924, 0.8213, 0.4552, 0.4416, 0.4522, 0.0693, 0.9656, 0.4524, 0.3621,
0.3948, 0.0576, 0.8844, 0.6006, 0.1344, 0.9479, 0.9998, 0.4752, 0.0102, 0.2072, 0.2558, 0.6398,
0.5894, 0.3594, 0.2062, 0.6746, 0.0226, 0.7145, 0.2707, 0.0881, 0.2819, 0.4720, 0.1816, 0.3449,
0.1154, 0.9878, 0.2127, 0.0264, 0.5358, 0.9928, 0.1909, 0.5698, 0.6153, 0.2677, 0.7599, 0.6943,
0.3390, 0.8062, 0.6588, 0.8160, 0.2128, 0.7087, 0.3170, 0.0772, 0.5144, 0.3315, 0.7106, 0.9799,
0.9585, 0.5769, 0.4569, 0.3773, 0.3356, 0.9656, 0.5962, 0.1314, 0.7709, 0.5703, 0.3531, 0.4550,
0.1647, 0.5072, 0.4311, 0.0593, 0.9826, 0.5309, 0.0340, 0.6411, 0.9439, 0.5538, 0.6918, 0.2411,
0.3379, 0.9418, 0.4585, 0.7794, 0.2453, 0.4041, 0.1384, 0.4557, 0.8641, 0.0658, 0.4055, 0.3563,
0.3369, 0.9223, 0.6855, 0.3491, 0.8203, 0.4842, 0.8249, 0.8541, 0.8805, 0.3812, 0.8233, 0.8399,
0.0894, 0.6512, 0.3242, 0.5505, 0.0614, 0.1895, 0.7830, 0.7323, 0.1136, 0.2808, 0.6898, 0.8308,
0.4299, 0.7024, 0.2886, 0.9437, 0.0056, 0.4341, 0.8946, 0.0160, 0.5595, 0.6161, 0.8833, 0.2230,
0.9689, 0.0147, 0.7529, 0.1959, 0.8463, 0.2558, 0.6789, 0.5238, 0.8193, 0.3457, 0.6326, 0.6250,
0.6896, 0.2192, 0.0287, 0.1398, 0.8823, 0.2135, 0.0966, 0.2357, 0.2275, 0.0473, 0.1087, 0.3164,
0.7329, 0.3243, 0.7061, 0.6711, 0.1662, 0.0483, 0.0563, 0.9740, 0.1591, 0.7708, 0.0704, 0.6592,
0.7248, 0.3347, 0.2433, 0.7515, 0.7260, 0.7344, 0.6190, 0.2775, 0.6044, 0.9416, 0.8660, 0.1284,
0.1725, 0.0741, 0.2718, 0.3056, 0.3304, 0.4926, 0.3303, 0.4984, 0.3834, 0.8002, 0.8914, 0.6215,
0.0359, 0.4620, 0.9602, 0.9320, 0.6280, 0.7745, 0.5548, 0.6790, 0.0503, 0.8437, 0.1390, 0.3750,
0.4484, 0.4238, 0.4920, 0.2550, 0.1828, 0.2405, 0.9776, 0.2629, 0.4701, 0.6882, 0.1180, 0.4763,
0.3727, 0.2714, 0.9070, 0.5169, 0.6318, 0.4624, 0.7180, 0.9389, 0.2781, 0.5681, 0.0473, 0.5675,
0.0176, 0.4216, 0.1200, 0.0205, 0.9300, 0.6019, 0.1989, 0.3869, 0.7797, 0.9605, 0.8488, 0.2605,
0.9071, 0.8421, 0.3658, 0.7958, 0.1133, 0.9073, 0.8078, 0.1597, 0.2675, 0.7635, 0.3967, 0.7322,
0.5454, 0.2216, 0.9418, 0.4797, 0.6776, 0.0744, 0.0149, 0.9918, 0.4501, 0.1995, 0.0219, 0.2652,
0.7582, 0.5635, 0.3921, 0.8644, 0.6375, 0.5791, 0.3497, 0.3960, 0.0517, 0.0170, 0.9427, 0.0569,
0.4486, 0.3755, 0.0872, 0.0707, 0.5414, 0.6842, 0.2566, 0.9477, 0.2459, 0.1522, 0.2634, 0.5196,
0.1925, 0.9455, 0.5259, 0.1522, 0.9958, 0.3119, 0.1910, 0.8665, 0.7167, 0.8022, 0.4041, 0.7583,
0.1617, 0.8675, 0.3162, 0.4109, 0.4910, 0.2854, 0.9671, 0.0575, 0.7508, 0.1396, 0.2048, 0.8076,
0.2055, 0.3549, 0.0894, 0.4148, 0.2550, 0.8910, 0.0639, 0.0948, 0.5199, 0.6828, 0.5411, 0.4708,
0.9138, 0.0577, 0.5858, 0.5572, 0.8022, 0.2573, 0.6637, 0.6985, 0.4925, 0.7047, 0.1612, 0.3012,
0.1606, 0.3373, 0.4622, 0.8821, 0.0936, 0.4566, 0.2228, 0.4420, 0.1749, 0.9004, 0.0922, 0.4577,
0.9192, 0.4716, 0.5670, 0.7587, 0.9876, 0.6316, 0.4314, 0.5350, 0.5708, 0.7469, 0.9830, 0.5162,
0.1136, 0.9147, 0.6551, 0.0344, 0.3842, 0.0260, 0.6000, 0.6841, 0.8068, 0.2089, 0.6191, 0.6718,
0.0674, 0.7980, 0.8212, 0.5060, 0.4402, 0.9220, 0.3917, 0.8033, 0.2547, 0.7375, 0.3425, 0.1568,
0.4185, 0.3453, 0.4179, 0.2523, 0.9233, 0.2993, 0.2420, 0.7774, 0.2305, 0.7818, 0.5761, 0.5921,
0.0602, 0.8394, 0.6440, 0.2423, 0.4759, 0.7177, 0.8173, 0.8804, 0.8473, 0.3314, 0.9480, 0.5946,
0.0275, 0.7531, 0.0524, 0.5193, 0.0699, 0.2870, 0.8633, 0.1998, 0.3708, 0.6896, 0.6466, 0.3701,
0.4517, 0.4160, 0.0965, 0.8699, 0.7603, 0.8440, 0.1770, 0.2629, 0.8066, 0.1077, 0.2753, 0.4856,
0.6183, 0.8369, 0.1231, 0.0284, 0.6271, 0.9489, 0.5054, 0.5602, 0.1891, 0.5877, 0.3150, 0.6547,
0.7127, 0.0948, 0.8927, 0.5283, 0.2022, 0.5464, 0.7735, 0.6994, 0.4065, 0.3490, 0.8325, 0.1736,
0.0186, 0.6617, 0.2689, 0.2674, 0.0569, 0.2270, 0.2367, 0.6661, 0.7581, 0.0134, 0.7354, 0.1507,
0.9665, 0.7002, 0.1217, 0.3640, 0.6632, 0.0439, 0.2933, 0.0169, 0.4189, 0.0734, 0.6526, 0.8330,
0.8631, 0.0220, 0.3250, 0.8507, 0.4502, 0.6067, 0.6799, 0.2617, 0.6917, 0.2654, 0.3538, 0.7141,
0.2317, 0.5734, 0.7523, 0.6566, 0.1862, 0.0554, 0.0922, 0.5330, 0.2452, 0.4912, 0.2481, 0.5851,
0.7909, 0.8000, 0.7952, 0.9212, 0.6591, 0.7154, 0.8502, 0.4318, 0.4889, 0.4126, 0.7172, 0.1734,
0.9232, 0.4989, 0.3707, 0.3527, 0.1590, 0.5195, 0.8731, 0.1446, 0.7839, 0.6191, 0.9360, 0.0741,
0.8593, 0.6206, 0.1892, 0.3108, 0.2383, 0.4075, 0.4595, 0.4527, 0.3989, 0.5020, 0.1419, 0.1472,
0.7395, 0.4734, 0.0094, 0.5460, 0.7695, 0.6226, 0.2667, 0.3586, 0.1512, 0.0498, 0.5608, 0.6719,
0.6643, 0.4544, 0.8829, 0.5183, 0.6580, 0.1612, 0.0546, 0.3401, 0.8758, 0.6504, 0.8447, 0.8989,
0.0032, 0.3637, 0.0666, 0.9218, 0.3956, 0.4140, 0.8151, 0.3045, 0.4790, 0.0333, 0.1219, 0.5217,
0.0550, 0.9180, 0.3394, 0.2080, 0.4898, 0.3266, 0.5105, 0.1003, 0.8623, 0.9600, 0.4280, 0.1716,
0.8687, 0.6247, 0.2450, 0.0393, 0.4673, 0.8824, 0.5741, 0.2616, 0.2525, 0.4232, 0.8026, 0.6721,
0.7774, 0.4206, 0.5403, 0.7566, 0.3000, 0.0696, 0.0834, 0.6143, 0.7684, 0.8715, 0.2687, 0.8798,
0.5270, 0.2900, 0.7482, 0.4358, 0.8938, 0.9055, 0.0782, 0.3443, 0.2901, 0.6674, 0.7442, 0.4545,
0.9276, 0.1577, 0.7743, 0.9139, 0.5913, 0.7196, 0.5714, 0.6425, 0.8130, 0.1528, 0.5689, 0.8718,
0.5646, 0.2061, 0.0226, 0.9084, 0.1287, 0.8633, 0.8797, 0.2627, 0.0587, 0.9449, 0.5436, 0.0069,
0.2278, 0.7424, 0.2036, 0.3248, 0.6132, 0.8961, 0.3589, 0.7821, 0.0082, 0.3336, 0.2046, 0.9904,
0.4334, 0.4468, 0.4194, 0.4541, 0.9865, 0.2506, 0.6593, 0.5965, 0.1799, 0.4910, 0.0655, 0.3783,
0.0312, 0.5324, 0.3564, 0.2815, 0.0881, 0.4988, 0.9483, 0.5531, 0.7395, 0.4989, 0.7893, 0.0862,
0.8662, 0.7765, 0.4203, 0.3790, 0.9900, 0.4565, 0.2545, 0.0708, 0.2873, 0.7621, 0.9104, 0.2218,
0.2609, 0.6252, 0.2102, 0.0812, 0.1486, 0.3883, 0.2861, 0.2810, 0.4450, 0.8498, 0.0553, 0.3750,
0.2199, 0.6776, 0.6611, 0.4084, 0.7278, 0.2242, 0.6416, 0.8798, 0.9992, 0.0821, 0.4427, 0.9584,
0.4441, 0.8825, 0.4673, 0.1799, 0.1837, 0.3397, 0.1001, 0.9256, 0.6966, 0.0301, 0.6251, 0.5000,
0.3583, 0.6634, 0.0619, 0.1001, 0.3198, 0.2669, 0.4401, 0.8674, 0.9686, 0.1544, 0.0987, 0.4023,
0.8954, 0.3576, 0.1451, 0.1570, 0.3312, 0.0409, 0.7312, 0.9333, 0.5497, 0.6837, 0.1960, 0.2981,
0.1880, 0.3880, 0.8876, 0.9084, 0.3321, 0.1035, 0.9059, 0.6056, 0.4664, 0.6712, 0.2825, 0.8228,
0.2030, 0.9886, 0.0595, 0.2641, 0.1698, 0.3786, 0.7347, 0.4828, 0.8897, 0.1525, 0.5013, 0.6452,
0.1163, 0.8718, 0.6706, 0.8684, 0.5794, 0.6102, 0.0234, 0.3598, 0.7121, 0.8624, 0.0483, 0.1297,
0.1363, 0.8615, 0.1631, 0.0430, 0.7989, 0.3579, 0.0079, 0.9224, 0.3424, 0.9014, 0.9885, 0.8252,
0.0713, 0.3918, 0.4104, 0.1197, 0.5589, 0.4864, 0.6761, 0.4916, 0.1196, 0.8614, 0.3842, 0.1927,
0.3578, 0.1429, 0.2314, 0.3969, 0.5193, 0.1918, 0.3461, 0.1682, 0.1737, 0.4531, 0.8011, 0.6870,
0.4000, 0.6936, 0.7518, 0.0599, 0.8956, 0.8390, 0.2035, 0.4954, 0.1094, 0.3181, 0.7839, 0.3399,
0.5933, 0.8465, 0.6781, 0.1730, 0.7611, 0.3511, 0.2750, 0.9972, 0.6067, 0.2083, 0.0593, 0.7771,
0.7336, 0.5061, 0.7097, 0.3683, 0.0560, 0.0454, 0.7821, 0.2080, 0.6951, 0.6261, 0.9388, 0.0435,
0.6367, 0.0142, 0.0612, 0.7911, 0.8018, 0.4403, 0.7058, 0.3386, 0.7134, 0.0715, 0.1913, 0.1639,
0.4208, 0.5751, 0.6841, 0.4704, 0.5060, 0.9655, 0.1956, 0.0143, 0.7026, 0.2707, 0.8401, 0.9320,
0.3146, 0.0937, 0.7677, 0.5158, 0.3956, 0.6159, 0.1169, 0.1046, 0.5335, 0.2171, 0.1709, 0.2206,
0.5221, 0.2102, 0.6459, 0.5207, 0.3024, 0.7495, 0.1593, 0.8245, 0.1587, 0.0621, 0.3478, 0.9931,
0.9849, 0.6659, 0.3797, 0.2273, 0.5501, 0.5252, 0.4016, 0.6756, 0.4166, 0.6277, 0.3092, 0.8964,
0.8065, 0.2302, 0.0297, 0.1652, 0.2134, 0.1561, 0.7661, 0.2023, 0.1018, 0.8318, 0.1614, 0.7160,
0.9848, 0.0272, 0.0664, 0.3762, 0.8509, 0.9370, 0.7883, 0.5577, 0.7783, 0.9924, 0.1781, 0.5212,
0.2785, 0.0561, 0.5790, 0.9172, 0.0146, 0.6651, 0.8737, 0.3780, 0.6945, 0.2548, 0.1509, 0.7340,
0.1141, 0.0440, 0.5795, 0.3660, 0.4669, 0.6081, 0.2464, 0.9149, 0.3738, 0.6178, 0.0610, 0.1023,
0.7309, 0.6330, 0.2440, 0.0662, 0.1037, 0.0174, 0.2266, 0.4665, 0.2377, 0.5810, 0.5607, 0.2228,
0.3750, 0.7235, 0.9239, 0.2181, 0.6494, 0.0432, 0.4611, 0.9679, 0.5819, 0.6102, 0.5474, 0.2093,
0.4281, 0.3239, 0.5962, 0.8323, 0.8053, 0.5785, 0.8249, 0.3485, 0.0454, 0.0642, 0.5224, 0.3166,
0.8215, 0.8704, 0.8172, 0.1324, 0.5769, 0.7824, 0.4746, 0.8836, 0.1744, 0.0066, 0.8862, 0.3806,
0.8077, 0.7572, 0.0945, 0.6717, 0.7669, 0.8171, 0.2677, 0.4765, 0.6814, 0.5802, 0.0272, 0.7072,
0.7072, 0.3315, 0.2408, 0.1731, 0.5140, 0.4024, 0.3096, 0.8379, 0.4974, 0.1214, 0.5741, 0.5301,
0.9507, 0.2057, 0.8492, 0.0986, 0.9540, 0.8256, 0.3032, 0.5236, 0.1060, 0.8597, 0.4363, 0.1668,
0.8751, 0.4531, 0.6953, 0.0775, 0.3571, 0.4292, 0.3694, 0.0468, 0.7706, 0.9492, 0.6332, 0.7127,
0.0535, 0.2075, 0.5490, 0.6166, 0.1793, 0.7869, 0.1175, 0.5916, 0.5533, 0.9797, 0.5140, 0.8663,
0.5448, 0.2322, 0.8659, 0.1355, 0.6098, 0.8577, 0.2029, 0.7736, 0.2332, 0.8479, 0.9824, 0.9900,
0.2296, 0.5048, 0.9732, 0.3738, 0.8063, 0.5207, 0.0476, 0.6362, 0.7900, 0.9155, 0.5144, 0.7421,
0.3148, 0.4336, 0.6893, 0.9234, 0.0103, 0.4247, 0.4179, 0.2362, 0.6200, 0.7514, 0.7458, 0.1293,
0.0319, 0.6682, 0.4098, 0.0082, 0.5155, 0.2699, 0.9162, 0.4220, 0.0198, 0.7698, 0.8889, 0.2265,
0.2284, 0.8426, 0.1355, 0.5851, 0.4055, 0.7714, 0.7313, 0.6944, 0.0336, 0.6286, 0.3899, 0.7343,
0.2339, 0.2330, 0.0941, 0.2419, 0.8157, 0.6033, 0.6145, 0.1637, 0.7041, 0.4716, 0.8172, 0.7455,
0.0446, 0.5119, 0.9583, 0.6318, 0.4024, 0.1969, 0.4269, 0.0839, 0.4373, 0.6420, 0.5130, 0.2065,
0.0351, 0.4926, 0.8897, 0.8026, 0.2866, 0.8792, 0.5077, 0.1702, 0.3654, 0.8696, 0.2112, 0.8746,
0.9496, 0.0001, 0.2778, 0.5240, 0.6275, 0.1066, 0.9478, 0.7232, 0.6325, 0.7270, 0.5418, 0.8379,
0.3271, 0.9004, 0.5012, 0.7896, 0.4029, 0.7869, 0.8351, 0.1839, 0.9064, 0.6020, 0.1865, 0.9000,
0.3674, 0.2781, 0.1235, 0.2831, 0.4239, 0.5024, 0.5109, 0.8184, 0.9621, 0.5880, 0.5142, 0.3539,
0.7571, 0.0526, 0.2080, 0.5689, 0.5791, 0.4464, 0.5152, 0.1119, 0.6797, 0.0997, 0.2185, 0.1698,
0.4835, 0.3803, 0.7640, 0.4466, 0.7961, 0.3786, 0.2603, 0.1545, 0.1948, 0.8397, 0.7442, 0.9384,
0.0507, 0.9901, 0.8727, 0.9777, 0.9498, 0.4616, 0.3643, 0.8832, 0.7852, 0.8734, 0.3742, 0.3409,
0.7003, 0.3996, 0.2538, 0.7463, 0.5490, 0.5345, 0.9800, 0.1142, 0.5518, 0.4742, 0.9745, 0.0309,
0.7244, 0.9167, 0.2419, 0.2367, 0.7643, 0.1860, 0.5274, 0.3677, 0.0449, 0.9868, 0.1521, 0.5422,
0.2753, 0.7274, 0.2092, 0.1002, 0.2431, 0.3460, 0.4306, 0.4884, 0.7939, 0.0878, 0.5558, 0.9112,
0.8917, 0.1193, 0.8055, 0.7353, 0.5422, 0.1144, 0.3883, 0.9599, 0.6144, 0.5302, 0.6713, 0.5600,
0.7078, 0.5987, 0.4050, 0.0004, 0.1194, 0.8158, 0.3260, 0.6882, 0.3099, 0.2161, 0.3711, 0.7756,
0.1624, 0.2091, 0.5068, 0.8226, 0.9621, 0.4584, 0.8685, 0.4090, 0.8258, 0.2341, 0.8013, 0.5697,
0.4232, 0.0046, 0.6826, 0.5212, 0.5431, 0.5300, 0.7428, 0.7758, 0.5375, 0.5036, 0.8719, 0.6767,
0.2822, 0.0478, 0.3651, 0.7670, 0.7306, 0.9302, 0.6607, 0.3270, 0.6720, 0.5225, 0.1127, 0.5684,
0.8319, 0.9204, 0.4280, 0.1301, 0.1065, 0.1656, 0.3884, 0.6008, 0.4291, 0.0518, 0.3908, 0.0715,
0.2115, 0.1221, 0.4611, 0.6159, 0.0888, 0.2339, 0.7245, 0.4697, 0.2664, 0.8713, 0.8074, 0.9901,
0.1177, 0.9472, 0.9226, 0.1479, 0.4321, 0.1418, 0.3849, 0.4511, 0.0930, 0.1314, 0.6014, 0.1801,
0.2114, 0.6433, 0.3461, 0.3051, 0.2701, 0.3298, 0.4109, 0.9614, 0.5891, 0.3378, 0.8707, 0.9282,
0.9313, 0.9527, 0.5424, 0.3019, 0.3489, 0.9458, 0.9443, 0.1682, 0.2979, 0.1582, 0.1850, 0.0329,
0.9725, 0.4788, 0.2195, 0.2942, 0.3154, 0.1190, 0.7344, 0.9786, 0.1639, 0.6548, 0.2350, 0.3887,
0.9534, 0.7592, 0.6701, 0.6210, 0.8011, 0.4538, 0.5587, 0.1414, 0.4177, 0.5292, 0.2784, 0.7959,
0.6279, 0.7712, 0.8907, 0.4608, 0.3529, 0.1194, 0.2119, 0.8800, 0.4925, 0.7034, 0.7945, 0.8631,
0.0238, 0.1023, 0.1045, 0.0963, 0.0461, 0.7405, 0.5394, 0.7275, 0.3428, 0.4134, 0.1061, 0.6930,
0.7817, 0.7093, 0.8871, 0.2415, 0.7604, 0.9943, 0.0089, 0.8921, 0.9719, 0.8663, 0.2630, 0.4596,
0.5928, 0.6625, 0.7963, 0.3137, 0.6636, 0.8508, 0.1648, 0.1173, 0.6211, 0.9365, 0.1321, 0.2146,
0.2610, 0.9649, 0.2151, 0.4647, 0.7730, 0.5974, 0.3245, 0.4910, 0.0522, 0.7767, 0.0889, 0.6656,
0.9083, 0.0043, 0.5807, 0.7121, 0.2685, 0.3106, 0.6595, 0.0260, 0.8525, 0.7578, 0.8084, 0.0458,
0.7554, 0.5387, 0.2368, 0.3786, 0.4244, 0.5239, 0.2897, 0.1052, 0.1843, 0.8235, 0.6650, 0.1399,
0.5682, 0.3423, 0.0856, 0.6078, 0.0203, 0.1334, 0.1400, 0.5383, 0.5817, 0.4143, 0.6710, 0.3169,
0.2929, 0.9324, 0.9461, 0.4653, 0.1766, 0.7234, 0.6340, 0.5514, 0.7646, 0.9958, 0.4568, 0.3867,
0.8333, 0.5875, 0.2066, 0.7446, 0.5938, 0.2957, 0.7118, 0.4230, 0.1756, 0.4141, 0.5191, 0.2068,
0.9903, 0.4848, 0.5638, 0.6600, 0.8947, 0.4156, 0.1010, 0.6335, 0.5501, 0.2428, 0.8697, 0.8338,
0.0671, 0.8864, 0.5694, 0.4990, 0.3433, 0.4073, 0.5892, 0.6628, 0.7281, 0.7620, 0.9929, 0.7509,
0.1118, 0.6594, 0.4122, 0.2587, 0.2996, 0.6049, 0.5172, 0.5752, 0.5907, 0.7753, 0.9947, 0.3946,
0.4962, 0.0718, 0.0311, 0.7756, 0.4294, 0.6956, 0.5137, 0.4756, 0.1159, 0.8083, 0.9232, 0.3752,
0.2957, 0.4230, 0.0698, 0.0092, 0.9592, 0.8339, 0.4615, 0.0675, 0.2759, 0.6200, 0.7777, 0.1577,
0.5968, 0.9379, 0.6255, 0.4194, 0.0866, 0.9799, 0.5236, 0.8700, 0.0484, 0.0587, 0.6156, 0.9537,
0.8631, 0.7784, 0.9796, 0.9577, 0.0822, 0.7437, 0.3389, 0.7945, 0.3556, 0.2845, 0.8279, 0.3209,
0.2590, 0.2299, 0.9181, 0.1651, 0.1731, 0.6868, 0.9538, 0.1115, 0.5299, 0.0928, 0.4748, 0.7414,
0.3982, 0.2442, 0.0334, 0.0340, 0.4887, 0.3128, 0.1102, 0.9503, 0.9947, 0.6723, 0.4705, 0.5680,
0.2747, 0.3596, 0.8109, 0.4405, 0.7745, 0.5835, 0.3186, 0.6892, 0.7975, 0.9308, 0.3579, 0.9145,
0.2463, 0.1419, 0.1866, 0.1118, 0.8262, 0.7963, 0.4654, 0.8936, 0.6369, 0.1064, 0.1960, 0.7452,
0.1501, 0.6717, 0.2077, 0.0472, 0.5776, 0.1897, 0.9559, 0.3325, 0.9695, 0.0399, 0.1735, 0.1678,
0.0819, 0.8307, 0.8914, 0.4903, 0.1562, 0.4483, 0.1463, 0.8173, 0.5147, 0.6939, 0.6642, 0.4513,
0.1720, 0.9388, 0.5951, 0.6581, 0.8954, 0.6403, 0.3500, 0.6193, 0.0692, 0.5815, 0.8567, 0.9566,
0.6062, 0.2675, 0.1496, 0.9647, 0.7446, 0.4129, 0.3107, 0.9917, 0.3163, 0.2053, 0.7907, 0.8031,
0.0905, 0.7533, 0.6972, 0.0766, 0.9857, 0.1875, 0.8868, 0.0314, 0.8298, 0.1599, 0.2393, 0.0882,
0.7739, 0.8183, 0.9246, 0.3683, 0.0994, 0.3410, 0.3409, 0.0995, 0.7360, 0.0321, 0.9311, 0.5466,
0.0302, 0.9912, 0.4603, 0.0067, 0.0186, 0.8585, 0.4710, 0.5233, 0.5274, 0.8132, 0.8418, 0.8681,
0.9932, 0.0321, 0.4357, 0.9036, 0.8865, 0.2463, 0.7595, 0.1847, 0.2966, 0.3120, 0.7881, 0.7882,
0.4392, 0.0743, 0.8231, 0.4903, 0.2692, 0.4200, 0.0205, 0.5155, 0.4867, 0.8286, 0.2115, 0.4072,
0.7340, 0.8313, 0.5476, 0.0846, 0.2948, 0.9923, 0.9086, 0.6464, 0.2194, 0.2508, 0.7932, 0.7917,
0.7480, 0.4466, 0.9171, 0.9662, 0.6360, 0.1033, 0.3689, 0.0226, 0.1219, 0.1636, 0.0537, 0.5534,
0.9012, 0.4514, 0.8269, 0.0030, 0.0220, 0.8470, 0.8184, 0.4004, 0.4438, 0.3353, 0.2542, 0.1214,
0.9284, 0.3783, 0.0716, 0.7767, 0.1778, 0.9255, 0.0317, 0.1533, 0.9114, 0.7733, 0.3657, 0.4851,
0.2679, 0.7910, 0.3138, 0.4561, 0.9790, 0.6821, 0.7668, 0.6780, 0.6386, 0.3458, 0.6542, 0.1425,
0.5063, 0.4943, 0.2321, 0.1935, 0.2332, 0.1243, 0.0444, 0.1559, 0.9396, 0.5599, 0.4384, 0.0182,
0.7829, 0.3955, 0.1844, 0.3546, 0.2143, 0.0394, 0.9692, 0.2512, 0.1540, 0.9062, 0.6853, 0.0468,
0.7251, 0.5543, 0.4069, 0.1063, 0.9521, 0.9909, 0.4669, 0.4456, 0.0824, 0.2244, 0.8041, 0.3424,
0.1766, 0.0547, 0.9575, 0.3578, 0.8677, 0.9216, 0.5873, 0.4938, 0.7273, 0.3260, 0.0515, 0.1508,
0.8618, 0.6882, 0.4316, 0.2477, 0.2786, 0.8712, 0.8053, 0.0757, 0.0670, 0.4544, 0.9705, 0.1700,
0.5627, 0.5385, 0.5587, 0.6929, 0.8375, 0.5613, 0.1043, 0.4310, 0.8375, 0.7125, 0.8424, 0.4179,
0.3937, 0.5110, 0.8188, 0.1007, 0.1515, 0.2133, 0.0981, 0.7789, 0.5835, 0.2496, 0.1195, 0.4851,
0.5896, 0.1421, 0.9955, 0.6624, 0.7951, 0.6993, 0.5715, 0.2448, 0.5443, 0.1243, 0.4649, 0.5769,
0.6212, 0.6807, 0.4062, 0.5736, 0.9449, 0.8977, 0.9641, 0.9704};

float sample_bit(int seed, int x, int y) {
	return noise_matrix[std::abs((long)(x * 219586 + x * (seed-719385) * y + 519385 * y + seed)) % 2048];
}

float point_corruption_line(float x, float y, float x1, float y1, float x2, float y2) {
	x2 -= x1; y2 -= y1; x -= x1; y -= y1;
	float a = std::atan2(y2, x2);
	return std::abs((x * cos(a) - y * sin(a)));
}

float sample_net(int seed, int x, int y, float w, float h) {
	int a, b;
	float s = 0.0;
	
	float xr = (float) x + (sample_bit(seed, x, y) - 0.5) * 4.0;
	float yr = (float) y + (sample_bit(seed + 1, x, y) - 0.5) * 4.0;
	
	for(a = -1; a <= 1; a++)
		for(b = -1; b <= 1; b++) {
			if(!a && !b)
				continue;
			float i = ((float) x + a) + (sample_bit(seed, x + a, y + b) - 0.5) * 4.0;
			float j = ((float) y + b) + (sample_bit(seed + 1, x + a, y + b) - 0.5) * 4.0;
			s += std::max(0.0, 1.0 - point_corruption_line(w, h, xr, yr, i, j));
	}
	return s / 4.0;
}

float mix_corners(float a, float b, float c, float d, float x, float y) {
	return a * (1.0-x) * (1.0-y) + b * (1.0-x) * y + c * x * y + d * x * (1.0-y);
}

/* * Extra
noise
A noise generator.
"simple"
"net"

sample(x, y)
	sample the noise at this position

C++
noise a("simple", 112, 64.0); //set seed to 112 and scale to 64

Python
a = noise('simple', 112, 64) #set seed to 112 and scale to 64
* */
noise::noise(const char* t, float u, float s) : seed(u), scale(s) {
	if(!strcmp(t, "simple"))
		type = 1;
	else if(!strcmp(t, "net"))
		type = 2;
	else {
		type = 0;
		err("noise", "matrix not found");
	}
}

float noise::sample(float x, float y, float s) {
	if(!s) s = scale;
	int real_x = std::floor(x / s), real_y = std::floor(y / s);
	float sub_x = x / s - (float) real_x, sub_y = y / s - (float) real_y;
	
	int bseed = (seed + real_y/10000 + real_x/10000) % 1000000000;
	real_x = real_x % 10000;
	real_y = real_y % 10000;
	
	if(type == 1)
		return mix_corners(
			sample_bit(bseed, real_x, real_y),
			sample_bit(bseed, real_x, real_y+1),
			sample_bit(bseed, real_x+1, real_y+1),
			sample_bit(bseed, real_x+1, real_y),
		sub_x, sub_y);
	else if(type == 2)
		return mix_corners(
			sample_net(bseed, real_x, real_y, x / s, y / s),
			sample_net(bseed, real_x, real_y+1, x / s, y / s),
			sample_net(bseed, real_x+1, real_y+1, x / s, y / s),
			sample_net(bseed, real_x+1, real_y, x / s, y / s),
		sub_x, sub_y);
	
	return 0.0;
}
